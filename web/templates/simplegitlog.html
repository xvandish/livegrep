
{{template "layout" .}}

<!-- start with table, move to divs with <flex if useful -->
{{ with .Data }}
<table id="log-table">
  <thead>
    <tr>
      <th>Short Hash</th>
      <th>Author</th>
      <th>Commit Date</th>
      <th>Subject</th>
    </tr>
  </thead>
  <tbody>
    {{range $commit := .Commits }}
      <tr>
        <td>{{$commit.ShortHash}}</td>
        <td>{{$commit.AuthorName}}</td>
        <td>{{$commit.Date}}</td>
        <td>
          <span>
          {{$commit.Subject}}
          </span>
          {{ if ne $commit.Body "" }}
            <span class="hidden-text-expander">
              <button type="button" class="ellipses-expander" data-action="expandText">â€¦</button>
            </span>
          {{ end }}
        </td>
        {{ if ne $commit.Body "" }}
        <td class='expanded-row-content hide-row'>
          <pre>{{$commit.Body}}</pre>
        </td>
        {{ end }}
      </tr>
    {{ end }}
  </tbody>
</table>
{{end}}

<script>
  const functionMap = {
    "expandText": expandText
  };

  function expandText(event) {
    // Get the row that triggered this click
    const row = event.target.closest('tr');
    row.querySelector('.expanded-row-content').classList.toggle('hide-row');
  }

  function dealWithClick(event) {
    if (event.target.tagName != "BUTTON") {
        return
    }

    functionMap[event.target.dataset.action](event);
  }

  document.getElementById('log-table').addEventListener('click', dealWithClick, false);
</script>
